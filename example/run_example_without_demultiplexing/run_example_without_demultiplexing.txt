./MPRAdecoder.py
Hello, user!

How many FASTQ files would you like to analyze? Type number: 
6
6 FASTQ files will be analyzed.

Enter first absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz
Enter second absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz
Enter third absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz
Enter next absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz
Enter next absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz
Enter next absolute path to file: /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz

You added 6 files:
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz
Is everything correct? Type Y to continue or N to restart previous step. 
y

Enter absolute path to your output folder (e.g. /mnt/d/User/output/): 
/mnt/d/Omelina_Desktop/NGS/2018-11-20/github/6samples-cont0/

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz would you like to analyze? Type number: 1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz? Type Y or N. 
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz? Type Y or N. 
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz? Type Y or N. 
y
Enter indexes for mapping replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
m1
Index M1 was successfully added.
n

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz would you like to analyze? Type number: 
1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz? Type Y or N. 
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz? Type Y or N. 
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz? Type Y or N. 
y
Enter indexes for mapping replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
m2
Index M2 was successfully added.
n

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz would you like to analyze? Type number: 
1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz? Type Y or N. 
y
Enter indexes for normalization replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
n1
Index N1 was successfully added.
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz? Type Y or N. 
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz? Type Y or N. 
n

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz would you like to analyze? Type number: 
1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz? Type Y or N. 
y
Enter indexes for normalization replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
n2
Index N2 was successfully added.
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz? Type Y or N. 
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz? Type Y or N. 
n

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz would you like to analyze? Type number: 
1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz? Type Y or N. 
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz? Type Y or N. 
y
Enter indexes for expression replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
e1
Index E1 was successfully added.
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz? Type Y or N. 
n

How many libraries in /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz would you like to analyze? Type number: 
1
1 libraries will be analyzed.
Enter first library name: 
example-libr
Do you have any normalization replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz? Type Y or N. 
n
Do you have any expression replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz? Type Y or N. 
y
Enter indexes for expression replicates of library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz.
If there are more than one index per replicate, print one index per line. Finally type N.
e2
Index E2 was successfully added.
n
Do you have any mapping replicates for library example-libr in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz? Type Y or N. 
n

You added 1 libraries:
Library example-libr.

Normalization replicate with indexes ['N1'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz.
Normalization replicate with indexes ['N2'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz.
Expression replicate with indexes ['E1'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz.
Expression replicate with indexes ['E2'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz.
Mapping replicate with indexes ['M1'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz.
Mapping replicate with indexes ['M2'] in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz.

Is everything correct? Type Y to continue or N to restart previous step. 
y

Please, check acceptable mismatch levels.
1 mismatches in indexes.
2 mismatches in BCs, 0 in ROIs.
4 mismatches in neCP1;
2 mismatches in neCP2.
2 mismatches in mCP1
For library example-libr 8 mismatches in mCP2;
1 mismatches for mCP3.
Minimum read count for normalization sample is 3.
Minimum read count for expression sample is 0.
Minimum read count for mapping sample is 1.

Would you like to change something? Type Y or N: 
n

Do you need to perform demultiplexing of your fastq file(s)? Type Y or N: 
n

Analysis was started 2021-03-23 11:15:35.245794

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz is 39304.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M1.fastq.gz was found:
39304 total reads, 35183 effective reads, 28 low quality reads and 23739 unique barcodes for index M1.

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz is 48285.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/M2.fastq.gz was found:
48285 total reads, 43179 effective reads, 29 low quality reads and 27422 unique barcodes for index M2.

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz is 112447.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N1.fastq.gz was found:
112447 total reads, 106732 effective reads, 5148 low quality reads and 55584 unique barcodes for index N1.

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz is 98608.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/N2.fastq.gz was found:
98608 total reads, 93446 effective reads, 4482 low quality reads and 51812 unique barcodes for index N2.

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz is 106678.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E1.fastq.gz was found:
106678 total reads, 100650 effective reads, 4873 low quality reads and 51379 unique barcodes for index E1.

Total read count in file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz is 109556.
In file /mnt/d/Omelina_Desktop/NGS/2018-11-20/github/E2.fastq.gz was found:
109556 total reads, 101469 effective reads, 4814 low quality reads and 51445 unique barcodes for index E2.

Analysis was finished 2021-03-23 11:25:01.079051
10253 BCs for mapping of library example-libr.

4388 BCs for normalization of library example-libr.

1704 unique BCs for library example-libr.

2021-03-23 11:25:04.820559
['1651 genuine BCs for library example-libr.\n', '23 BCs were removed from analysis due to high percent of chimeric molecules.\n']
2021-03-23 11:25:10.152896

---
./MPRAdecoder_stat.py
['1366 ROIs with 1 BCs for example-libr.\n', '27 ROIs with 2 BCs for example-libr.\n', '0 ROIs with 3 BCs for example-libr.\n', '0 ROIs with 4 BCs for example-libr.\n', '0 ROIs with 5 BCs for example-libr.\n', '0 ROIs with 6 BCs for example-libr.\n', '0 ROIs with 7 BCs for example-libr.\n', '0 ROIs with 8 BCs for example-libr.\n', '0 ROIs with 9 BCs for example-libr.\n', '0 ROIs with 10 BCs for example-libr.\n', '1 ROIs with more than 10 BCs for example-libr.\n', 'In library example-libr 231 wt ROIs.\n', 'For ROIs in lib example-libr log2 of normalyzed expressions does not look Gaussian.\nShapiro p-value=5.08694641965235e-10, K^2 p-value=6.777961359204564e-08.\n', 'In library example-libr 214 wt ROIs above zero.\n', 'For wt in lib example-libr log2 of normalyzed expressions looks Gaussian.\np-value=0.1442183256149292.\n']

ROIs in lib example-libr contains
0.25609756097560976 of A
0.23224533715925394 of T
0.18992109038737445 of G
0.3217360114777618 of C

1394 ROIs 8 bp long for example-libr

PWM for all ROIs8 bp long in lib example-libr
        0      1      2      3      4      5      6      7
A:   0.35   0.24   0.25   0.27   0.21   0.24   0.24   0.24
C:   0.33   0.30   0.32   0.33   0.32   0.32   0.32   0.33
G:   0.07   0.21   0.22   0.21   0.20   0.21   0.23   0.18
T:   0.25   0.25   0.21   0.19   0.27   0.23   0.21   0.25

ACCCCCCC
NNNNNNNN
PWM for high expressed ROIs8 bp long in lib example-libr
        0      1      2      3      4      5      6      7
A:   0.20   0.19   0.23   0.26   0.12   0.17   0.20   0.20
C:   0.40   0.38   0.31   0.36   0.33   0.30   0.36   0.29
G:   0.02   0.09   0.14   0.16   0.20   0.13   0.19   0.17
T:   0.38   0.34   0.31   0.23   0.36   0.40   0.26   0.34

CCCCTTCT
YNNNNNNN
PWM for low expressed ROIs8 bp long in lib example-libr
        0      1      2      3      4      5      6      7
A:   0.44   0.24   0.29   0.34   0.24   0.24   0.36   0.19
C:   0.36   0.31   0.36   0.23   0.29   0.31   0.26   0.46
G:   0.10   0.20   0.17   0.28   0.28   0.28   0.28   0.20
T:   0.10   0.24   0.19   0.14   0.19   0.16   0.10   0.16

ACCACCAC
MNNNNNNN
['256 k-mers 4 bp long were found in library example-libr.\n', '161 high k-mers 4 bp long were found in library example-libr.\n', '175 low k-mers 4 bp long were found in library example-libr.\n']
['1014 k-mers 5 bp long were found in library example-libr.\n', '231 high k-mers 5 bp long were found in library example-libr.\n', '237 low k-mers 5 bp long were found in library example-libr.\n']
['2471 k-mers 6 bp long were found in library example-libr.\n', '205 high k-mers 6 bp long were found in library example-libr.\n', '206 low k-mers 6 bp long were found in library example-libr.\n']
['2534 k-mers 7 bp long were found in library example-libr.\n', '140 high k-mers 7 bp long were found in library example-libr.\n', '139 low k-mers 7 bp long were found in library example-libr.\n']
